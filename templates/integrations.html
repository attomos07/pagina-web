<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Integraciones - Attomos</title>
    <link href="https://cdn.lineicons.com/4.0/lineicons.css" rel="stylesheet" />
    <link rel="stylesheet" href="/static/css/integrations.css">
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        {{template "sidebar.html" .}}

        <!-- Main Content -->
        <div class="main-content">
            <!-- Userbar -->
            {{template "userbar.html" .}}

            <!-- Content Wrapper -->
            <div class="content-wrapper">
                <div class="integrations-layout">
                    <!-- Page Header -->
                    <div class="page-header">
                        <div class="header-content">
                            <h1 class="page-title">
                                <i class="lni lni-plug"></i>
                                Integraciones
                            </h1>
                            <p class="page-subtitle">Conecta tus herramientas favoritas con Attomos</p>
                        </div>
                    </div>

                    <!-- Agent Selector -->
                    <div class="agent-selector">
                        <label class="selector-label">Selecciona un agente para configurar sus integraciones</label>
                        <div class="custom-select" id="agentSelect">
                            <div class="select-display" id="agentSelectDisplay">
                                Selecciona un agente...
                            </div>
                            <i class="lni lni-chevron-down select-arrow"></i>
                            <div class="select-dropdown" id="agentSelectDropdown">
                                <div class="select-options" id="agentSelectOptions">
                                    <!-- Agents will be loaded here dynamically -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Integrations Grid -->
                    <div class="integrations-grid" id="integrationsGrid">
                        <!-- Google Calendar Card -->
                        <div class="integration-card" id="googleCalendarCard">
                            <div class="card-header">
                                <div class="card-title">
                                    <svg class="integration-icon" width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <rect width="32" height="32" rx="7" fill="#4285F4"/>
                                        <path d="M23 13H19V9C19 8.448 18.552 8 18 8H14C13.448 8 13 8.448 13 9V13H9C8.448 13 8 13.448 8 14V18C8 18.552 8.448 19 9 19H13V23C13 23.552 13.448 24 14 24H18C18.552 24 19 23.552 19 23V19H23C23.552 19 24 18.552 24 18V14C24 13.448 23.552 13 23 13Z" fill="white"/>
                                        <path d="M10 6H22C23.105 6 24 6.895 24 8V10H8V8C8 6.895 8.895 6 10 6Z" fill="#EA4335"/>
                                        <rect x="9" y="4" width="2" height="4" rx="1" fill="#FBBC04"/>
                                        <rect x="21" y="4" width="2" height="4" rx="1" fill="#FBBC04"/>
                                    </svg>
                                    <h2>Google Calendar</h2>
                                </div>
                                <div class="status-badge disconnected" id="googleStatus">
                                    <span class="status-indicator"></span>
                                    No conectado
                                </div>
                            </div>

                            <p class="card-description">
                                Sincroniza citas automáticamente con Google Calendar. Tu agente podrá consultar disponibilidad y crear eventos.
                            </p>

                            <div class="card-features">
                                <ul class="feature-list">
                                    <li class="feature-item">
                                        <i class="lni lni-calendar"></i>
                                        Crear citas automáticamente
                                    </li>
                                    <li class="feature-item">
                                        <i class="lni lni-checkmark-circle"></i>
                                        Consultar disponibilidad en tiempo real
                                    </li>
                                    <li class="feature-item">
                                        <i class="lni lni-timer"></i>
                                        Recordatorios automáticos
                                    </li>
                                    <li class="feature-item">
                                        <i class="lni lni-sync"></i>
                                        Sincronización bidireccional
                                    </li>
                                </ul>
                            </div>

                            <!-- Connection Info (hidden by default) -->
                            <div class="connection-info" id="googleConnectionInfo" style="display: none;">
                                <div class="connection-details">
                                    <div class="connection-detail">
                                        <span class="connection-label">Calendar:</span>
                                        <a href="#" id="calendarLink" class="connection-link" target="_blank">
                                            Ver calendario
                                            <i class="lni lni-arrow-right"></i>
                                        </a>
                                    </div>
                                    <div class="connection-detail">
                                        <span class="connection-label">Conectado:</span>
                                        <span class="connection-value" id="connectedAt">-</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Action Buttons -->
                            <div class="card-actions" id="googleActions">
                                <button class="btn btn-connect" id="btnConnectGoogle" disabled>
                                    <i class="lni lni-link"></i>
                                    Conectar Calendar
                                </button>
                            </div>

                            <!-- Disconnect/Reconnect Buttons (hidden by default) -->
                            <div class="card-actions" id="googleManageActions" style="display: none;">
                                <button class="btn btn-secondary" id="btnReconnectGoogle">
                                    <i class="lni lni-reload"></i>
                                    Reconectar
                                </button>
                                <button class="btn btn-disconnect" id="btnDisconnectGoogle">
                                    <i class="lni lni-unlink"></i>
                                    Desconectar
                                </button>
                            </div>
                        </div>

                        <!-- Google Sheets Card -->
                        <div class="integration-card" id="googleSheetsCard">
                            <div class="card-header">
                                <div class="card-title">
                                    <svg class="integration-icon" width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <rect width="32" height="32" rx="7" fill="#0F9D58"/>
                                        <rect x="8" y="8" width="16" height="16" rx="1" fill="white"/>
                                        <line x1="8" y1="12" x2="24" y2="12" stroke="#0F9D58" stroke-width="1"/>
                                        <line x1="8" y1="16" x2="24" y2="16" stroke="#0F9D58" stroke-width="1"/>
                                        <line x1="8" y1="20" x2="24" y2="20" stroke="#0F9D58" stroke-width="1"/>
                                        <line x1="14" y1="8" x2="14" y2="24" stroke="#0F9D58" stroke-width="1"/>
                                        <line x1="19" y1="8" x2="19" y2="24" stroke="#0F9D58" stroke-width="1"/>
                                    </svg>
                                    <h2>Google Sheets</h2>
                                </div>
                                <div class="status-badge disconnected" id="googleSheetsStatus">
                                    <span class="status-indicator"></span>
                                    No conectado
                                </div>
                            </div>

                            <p class="card-description">
                                Registra automáticamente clientes y citas en una hoja de cálculo. Accede a tus datos desde cualquier lugar.
                            </p>

                            <div class="card-features">
                                <ul class="feature-list">
                                    <li class="feature-item">
                                        <i class="lni lni-files"></i>
                                        Registro automático de clientes
                                    </li>
                                    <li class="feature-item">
                                        <i class="lni lni-database"></i>
                                        Base de datos centralizada
                                    </li>
                                    <li class="feature-item">
                                        <i class="lni lni-bar-chart"></i>
                                        Reportes y análisis
                                    </li>
                                    <li class="feature-item">
                                        <i class="lni lni-cloud-sync"></i>
                                        Sincronización en la nube
                                    </li>
                                </ul>
                            </div>

                            <!-- Connection Info (hidden by default) -->
                            <div class="connection-info" id="googleSheetsConnectionInfo" style="display: none;">
                                <div class="connection-details">
                                    <div class="connection-detail">
                                        <span class="connection-label">Sheet:</span>
                                        <a href="#" id="sheetLink" class="connection-link" target="_blank">
                                            Ver hoja de citas
                                            <i class="lni lni-arrow-right"></i>
                                        </a>
                                    </div>
                                    <div class="connection-detail">
                                        <span class="connection-label">Conectado:</span>
                                        <span class="connection-value" id="sheetsConnectedAt">-</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Note: Uses same Google connection -->
                            <div class="card-note">
                                <i class="lni lni-information"></i>
                                <span>Google Sheets se conecta automáticamente cuando conectas Google Calendar</span>
                            </div>
                        </div>

                        <!-- Meta WhatsApp Card -->
                        <div class="integration-card" id="metaWhatsAppCard">
                            <div class="card-header">
                                <div class="card-title">
                                    <svg class="integration-icon" width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <rect width="32" height="32" rx="7" fill="#25D366"/>
                                        <path d="M16 6C10.477 6 6 10.477 6 16C6 17.89 6.525 19.66 7.438 21.166L6.5 25.5L10.98 24.589C12.437 25.418 14.158 25.9 16 25.9C21.523 25.9 26 21.423 26 15.9C26 10.377 21.523 6 16 6Z" fill="white"/>
                                        <path d="M20.5 18.5C20.25 19.25 19 20 18.375 20.125C17.875 20.225 17.25 20.25 16.5 20C16.125 19.875 15.625 19.7 15 19.375C13.125 18.5 11.875 16.625 11.75 16.5C11.625 16.375 10.75 15.25 10.75 14.125C10.75 13 11.375 12.5 11.625 12.25C11.875 12 12.125 11.925 12.25 11.925C12.375 11.925 12.5 11.925 12.625 11.925C12.75 11.925 12.925 11.875 13.125 12.25C13.375 12.75 13.875 13.875 13.925 13.975C14 14.1 14 14.25 13.925 14.375C13.85 14.5 13.75 14.625 13.625 14.75C13.5 14.875 13.375 15.025 13.25 15.125C13.125 15.225 13 15.35 13.125 15.6C13.25 15.85 13.75 16.75 14.5 17.375C15.5 18.25 16.375 18.5 16.625 18.625C16.875 18.75 17.025 18.7 17.125 18.6C17.25 18.475 17.75 17.975 17.875 17.725C18 17.475 18.125 17.5 18.375 17.6C18.625 17.7 19.75 18.25 20 18.375C20.25 18.5 20.425 18.55 20.5 18.65C20.575 18.75 20.575 19.25 20.5 18.5Z" fill="#25D366"/>
                                    </svg>
                                    <h2>Meta WhatsApp Business</h2>
                                </div>
                                <div class="status-badge" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); color: white;">
                                    <span class="status-indicator"></span>
                                    Próximamente
                                </div>
                            </div>

                            <p class="card-description">
                                Conecta la API oficial de WhatsApp Business para enviar mensajes, plantillas y acceder a funciones avanzadas.
                            </p>

                            <div class="card-features">
                                <ul class="feature-list">
                                    <li class="feature-item">
                                        <i class="lni lni-whatsapp"></i>
                                        API oficial de WhatsApp
                                    </li>
                                    <li class="feature-item">
                                        <i class="lni lni-files"></i>
                                        Plantillas pre-aprobadas
                                    </li>
                                    <li class="feature-item">
                                        <i class="lni lni-checkmark-circle"></i>
                                        Verificación empresarial
                                    </li>
                                    <li class="feature-item">
                                        <i class="lni lni-bar-chart"></i>
                                        Analytics avanzados
                                    </li>
                                </ul>
                            </div>
                        </div>

                        <!-- Placeholder for future integrations -->
                        <div class="integration-card coming-soon">
                            <div class="card-header">
                                <div class="card-title">
                                    <i class="lni lni-more"></i>
                                    <h2>Más integraciones próximamente</h2>
                                </div>
                                <div class="status-badge" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); color: white;">
                                    <span class="status-indicator"></span>
                                    Próximamente
                                </div>
                            </div>

                            <p class="card-description">
                                Estamos trabajando en nuevas integraciones para mejorar tu experiencia. ¿Qué herramienta te gustaría integrar?
                            </p>

                            <div class="card-features">
                                <ul class="feature-list">
                                    <li class="feature-item">
                                        <i class="lni lni-slack"></i>
                                        Slack
                                    </li>
                                    <li class="feature-item">
                                        <i class="lni lni-stripe"></i>
                                        Stripe Payments
                                    </li>
                                    <li class="feature-item">
                                        <i class="lni lni-envelope"></i>
                                        Email Marketing
                                    </li>
                                    <li class="feature-item">
                                        <i class="lni lni-cloud"></i>
                                        Y muchas más...
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- No Agent Selected State -->
                    <div class="empty-state" id="emptyState">
                        <i class="lni lni-inbox"></i>
                        <h3>Selecciona un agente</h3>
                        <p>Selecciona un agente del menú superior para ver y configurar sus integraciones</p>
                    </div>

                    <!-- No Agents State -->
                    <div class="empty-state" id="noAgentsState" style="display: none;">
                        <i class="lni lni-robot"></i>
                        <h3>No tienes agentes</h3>
                        <p>Crea tu primer agente para comenzar a usar las integraciones</p>
                        <a href="/onboarding" class="btn btn-connect" style="margin-top: 1.5rem;">
                            <i class="lni lni-plus"></i>
                            Crear Agente
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="/static/js/sidebar.js"></script>
    <script src="/static/js/integrations.js"></script>
</body>
</html>