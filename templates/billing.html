<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Facturación - Attomos</title>
    <link href="https://cdn.lineicons.com/4.0/lineicons.css" rel="stylesheet" />
    <link rel="stylesheet" href="/static/css/billing.css">
</head>
<body>
    <!-- Decorative Rings -->
    <div class="decorative-rings">
        <div class="ring ring-1"></div>
        <div class="ring ring-2"></div>
        <div class="ring ring-3"></div>
        <div class="ring ring-4"></div>
    </div>

    <div class="app-container">
        <!-- Sidebar -->
        {{template "sidebar.html" .}}

        <!-- Main Content -->
        <div class="main-content">
            <!-- Userbar -->
            {{template "userbar.html" .}}

            <!-- Content Wrapper -->
            <div class="content-wrapper">
                <div class="billing-layout">
                    <!-- Page Header -->
                    <div class="page-header">
                        <div class="header-content">
                            <h1 class="page-title">
                                <i class="lni lni-credit-cards"></i>
                                Historial de Pagos
                            </h1>
                            <p class="page-subtitle">Gestiona y revisa todas tus transacciones</p>
                        </div>
                        <a href="/plans" class="change-plan-btn">
                            <i class="lni lni-layers"></i>
                            <span>Cambiar Plan</span>
                        </a>
                    </div>

                    <!-- Summary Cards -->
                    <div class="summary-grid">
                        <!-- Total Pagado -->
                        <div class="summary-card">
                            <div class="summary-icon blue">
                                <i class="lni lni-credit-cards"></i>
                            </div>
                            <div class="summary-content">
                                <div class="summary-label">Total Pagado</div>
                                <div class="summary-value">$15.00</div>
                            </div>
                        </div>

                        <!-- Pagos Exitosos -->
                        <div class="summary-card">
                            <div class="summary-icon green">
                                <i class="lni lni-checkmark-circle"></i>
                            </div>
                            <div class="summary-content">
                                <div class="summary-label">Pagos Exitosos</div>
                                <div class="summary-value">1</div>
                            </div>
                        </div>

                        <!-- Último Pago -->
                        <div class="summary-card">
                            <div class="summary-icon purple">
                                <i class="lni lni-calendar"></i>
                            </div>
                            <div class="summary-content">
                                <div class="summary-label">Último Pago</div>
                                <div class="summary-value">08 Oct</div>
                            </div>
                        </div>
                    </div>

                    <!-- Current Subscription -->
                    <div class="subscription-card">
                        <div class="subscription-header">
                            <div class="subscription-title-wrapper">
                                <h2 class="subscription-title">Suscripción Actual</h2>
                                <span class="subscription-status active">Activa</span>
                            </div>
                            <a href="/billing/payment-method" class="edit-payment-btn">
                                <i class="lni lni-pencil"></i>
                                Editar Método de Pago
                            </a>
                        </div>

                        <div class="subscription-details">
                            <div class="subscription-info">
                                <div class="info-row">
                                    <span class="info-label">Plan:</span>
                                    <span class="info-value">Plan Protón</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">Precio:</span>
                                    <span class="info-value">$149 MXN / mes</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">Próximo cobro:</span>
                                    <span class="info-value">15 de Noviembre, 2025</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">Método de pago:</span>
                                    <span class="info-value">
                                        <i class="lni lni-mastercard"></i>
                                        •••• 4242
                                    </span>
                                </div>
                            </div>

                            <div class="subscription-actions">
                                <a href="/plans" class="action-link upgrade">
                                    <i class="lni lni-arrow-up-circle"></i>
                                    Actualizar Plan
                                </a>
                                <button class="action-link danger" onclick="cancelSubscription()">
                                    <i class="lni lni-close-circle"></i>
                                    Cancelar Suscripción
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Transactions Section -->
                    <div class="transactions-section">
                        <div class="transactions-header">
                            <h2 class="transactions-title">Transacciones Recientes</h2>
                            
                            <!-- Filter Tabs -->
                            <div class="filter-tabs">
                                <button class="filter-tab active" data-filter="all">
                                    <span>Todos</span>
                                </button>
                                <button class="filter-tab" data-filter="completed">
                                    <span>Completados</span>
                                </button>
                                <button class="filter-tab" data-filter="pending">
                                    <span>Pendientes</span>
                                </button>
                                <button class="filter-tab" data-filter="failed">
                                    <span>Fallidos</span>
                                </button>
                            </div>
                        </div>

                        <!-- Transactions Table -->
                        <div class="transactions-table-wrapper">
                            <table class="transactions-table">
                                <thead>
                                    <tr>
                                        <th class="th-id">ID TRANSACCIÓN</th>
                                        <th>FECHA</th>
                                        <th>PLAN</th>
                                        <th>PERÍODO</th>
                                        <th>MONTO</th>
                                        <th>ESTADO</th>
                                        <th>ACCIONES</th>
                                    </tr>
                                </thead>
                                <tbody id="transactionsTableBody">
                                    <!-- Transaction Row 1 -->
                                    <tr class="transaction-row" data-status="completed">
                                        <td class="transaction-id">
                                            <span class="id-text">pi_3SG0nqH0kpgdEo6U0L1bL...</span>
                                            <button class="copy-btn" onclick="copyToClipboard('pi_3SG0nqH0kpgdEo6U0L1bL...')" title="Copiar ID">
                                                <i class="lni lni-files"></i>
                                            </button>
                                        </td>
                                        <td class="transaction-date">08 Oct 2025</td>
                                        <td>
                                            <span class="plan-badge professional">Profesional</span>
                                        </td>
                                        <td class="transaction-period">Mensual</td>
                                        <td class="transaction-amount">$15.00 MXN</td>
                                        <td>
                                            <span class="status-badge completed">
                                                <i class="lni lni-checkmark-circle"></i>
                                                Activo
                                            </span>
                                        </td>
                                        <td>
                                            <button class="action-btn" onclick="downloadReceipt('pi_3SG0nqH0kpgdEo6U0L1bL...')">
                                                <i class="lni lni-download"></i>
                                                Recibo
                                            </button>
                                        </td>
                                    </tr>

                                    <!-- More transactions would be loaded dynamically -->
                                </tbody>
                            </table>

                            <!-- Empty State -->
                            <div class="empty-state" id="emptyState" style="display: none;">
                                <div class="empty-icon">
                                    <i class="lni lni-empty-file"></i>
                                </div>
                                <h3>No hay transacciones</h3>
                                <p>No se encontraron transacciones para este filtro</p>
                            </div>
                        </div>
                    </div>

                    <!-- Invoices Section -->
                    <div class="invoices-section">
                        <div class="invoices-header">
                            <h2 class="invoices-title">
                                <i class="lni lni-files"></i>
                                Facturas
                            </h2>
                            <button class="request-invoice-btn">
                                <i class="lni lni-plus"></i>
                                Solicitar Factura
                            </button>
                        </div>

                        <div class="invoices-grid">
                            <div class="invoice-card">
                                <div class="invoice-icon">
                                    <i class="lni lni-file"></i>
                                </div>
                                <div class="invoice-info">
                                    <div class="invoice-number">Factura #0001</div>
                                    <div class="invoice-date">08 Oct 2025</div>
                                    <div class="invoice-amount">$15.00 MXN</div>
                                </div>
                                <div class="invoice-actions">
                                    <button class="invoice-action-btn view" title="Ver factura">
                                        <i class="lni lni-eye"></i>
                                    </button>
                                    <button class="invoice-action-btn download" title="Descargar">
                                        <i class="lni lni-download"></i>
                                    </button>
                                </div>
                            </div>

                            <!-- More invoices would be displayed here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="/static/js/sidebar.js"></script>
    <script src="/static/js/billing.js"></script>
</body>
</html>